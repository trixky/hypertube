syntax = "proto3";

option go_package = "./proto";

package scrapper;

import "google/protobuf/timestamp.proto";

enum MediaCategory {
	CATEGORY_UNSPECIFIED = 0;
	CATEGORY_MOVIE = 1;
	CATEGORY_SERIE = 2;
}

message TorrentFile {
	string name = 1;
	optional string path = 2;
	optional string size = 3;
}

message UnprocessedTorrent {
	string full_url = 1;
	string name = 2;
	MediaCategory type = 3;
	repeated TorrentFile files = 4;
	optional string torrent_url = 5;
	optional int32 seed = 6;
	optional int32 leech = 7;
	optional string size = 8;
	optional google.protobuf.Timestamp upload_time = 9;
	optional string description_html = 10;
	optional string magnet = 11;
	optional string imdb_id = 12;
}

message Torrent {
	uint32 id = 1;
	string full_url = 2;
	string name = 3;
	MediaCategory type = 4;
	string torrent_url = 5;
	repeated TorrentFile files = 6;
	optional int32 seed = 7;
	optional int32 leech = 8;
	optional string size = 9;
	optional google.protobuf.Timestamp upload_time = 10;
	optional string description_html = 11;
	optional string magnet = 12;
	optional string imdb_id = 13;
}

message ScrapeRequest {
}

message ScrapeResponse {
	uint32 ms_duration = 1;
	repeated Torrent torrents = 2;
}

message Media {
	uint32 id = 1;
	string imdb_id = 2;
	string name = 3;
	string description = 4;
	uint32 year = 5;
	optional string duration = 6;
	optional string thumbnail = 7;
	optional string background = 8;
	optional string genres = 9;
	optional string rating = 10;
}

message ScrapeLatestRequest {
}

service ScrapperService {
	rpc ScrapeAll(ScrapeRequest) returns (stream ScrapeResponse) {};
	rpc ScrapeLatest(ScrapeLatestRequest) returns (stream ScrapeResponse) {};
}
